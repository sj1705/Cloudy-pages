(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[243],{9537:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit-post/[id]",function(){return e(124)}])},124:function(n,t,e){"use strict";e.r(t);var r=e(4051),o=e.n(r),i=e(5893),a=e(7294),u=e(552),c=e(3900),s=e(1163),d=e(5152),l=(e(1312),e(949)),p=e(9424),m=e(5934);function f(n,t,e,r,o,i,a){try{var u=n[i](a),c=u.value}catch(s){return void e(s)}u.done?t(c):Promise.resolve(c).then(r,o)}function g(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){f(i,r,o,a,u,"next",n)}function u(n){f(i,r,o,a,u,"throw",n)}a(void 0)}))}}function x(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function v(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},r=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(e).filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})))),r.forEach((function(t){x(n,t,e[t])}))}return n}var b=(0,d.default)((function(){return Promise.all([e.e(3126),e.e(1634),e.e(2562)]).then(e.bind(e,1634))}),{loadableGenerated:{webpack:function(){return[1634]}},ssr:!1});t.default=function(){var n=(0,a.useState)(null),t=n[0],e=n[1],r=(0,a.useState)(null),d=r[0],f=r[1],h=(0,a.useState)(null),y=h[0],P=h[1],$=(0,a.useRef)(null),k=(0,s.useRouter)(),I=k.query.id;if((0,a.useEffect)((function(){function n(){return(n=g(o().mark((function n(){var t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(I){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,u.b.graphql({query:p.xl,variables:{id:I}});case 4:t=n.sent,e(t.data.getPost),t.data.getPost.coverImage&&A(t.data.getPost.coverImage);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[I]),!t)return null;function A(n){return w.apply(this,arguments)}function w(){return(w=g(o().mark((function n(t){var e;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.Ke.get(t);case 2:e=n.sent,f(e);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function C(){return(C=g(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:$.current.click();case 1:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var T=t.title,O=t.content;function _(){return(_=g(o().mark((function n(){var t,e;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(T&&O){n.next=2;break}return n.abrupt("return");case 2:if(t={id:I,content:O,title:T},!d||!y){n.next=8;break}return e="".concat(d.name,"_").concat((0,m.Z)()),t.coverImage=e,n.next=8,c.Ke.put(e,d);case 8:return n.next=10,u.b.graphql({query:l.CP,variables:{input:t},authMode:"AMAZON_COGNITO_USER_POOLS"});case 10:k.push("/my-posts");case 11:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-semibold tracking-wide mt-6 mb-2",children:"Edit post"}),d&&(0,i.jsx)("img",{className:"mt-4",src:y||d}),(0,i.jsx)("input",{onChange:function(n){e((function(){return v({},t,x({},n.target.name,n.target.value))}))},name:"title",placeholder:"Title",value:t.title,className:"border-b pb-2 text-lg my-4 focus:outline-none w-full font-light text-gray-500 placeholder-gray-500 y-2"}),(0,i.jsx)(b,{value:t.content,onChange:function(n){return e(v({},t,{content:n}))}}),(0,i.jsx)("input",{type:"file",ref:$,className:"absolute w-0 h-0",onChange:function(n){var t=n.target.files[0];t&&(f(t),P(URL.createObjectURL(t)))}}),(0,i.jsx)("button",{className:"mb-4 bg-purple-600 text-white font-semibold px-8 py-2 rounded-lg",onClick:function(){return C.apply(this,arguments)},children:"Upload Cover Image"}),(0,i.jsx)("button",{className:"mb-4 bg-blue-600 text-white font-semibold px-8 py-2 rounded-lg",onClick:function(){return _.apply(this,arguments)},children:"Update Post"})]})}},949:function(n,t,e){"use strict";e.d(t,{qb:function(){return r},CP:function(){return o},fR:function(){return i},Yr:function(){return a}});var r="\n  mutation CreatePost(\n    $input: CreatePostInput!\n    $condition: ModelPostConditionInput\n  ) {\n    createPost(input: $input, condition: $condition) {\n      id\n      title\n      content\n      username\n      coverImage\n      comments {\n        items {\n          id\n          message\n          postID\n          createdAt\n          updatedAt\n          createdBy\n        }\n        nextToken\n      }\n      createdAt\n      updatedAt\n    }\n  }\n",o="\n  mutation UpdatePost(\n    $input: UpdatePostInput!\n    $condition: ModelPostConditionInput\n  ) {\n    updatePost(input: $input, condition: $condition) {\n      id\n      title\n      content\n      username\n      coverImage\n      comments {\n        items {\n          id\n          message\n          postID\n          createdAt\n          updatedAt\n          createdBy\n        }\n        nextToken\n      }\n      createdAt\n      updatedAt\n    }\n  }\n",i="\n  mutation DeletePost(\n    $input: DeletePostInput!\n    $condition: ModelPostConditionInput\n  ) {\n    deletePost(input: $input, condition: $condition) {\n      id\n      title\n      content\n      username\n      coverImage\n      comments {\n        items {\n          id\n          message\n          postID\n          createdAt\n          updatedAt\n          createdBy\n        }\n        nextToken\n      }\n      createdAt\n      updatedAt\n    }\n  }\n",a="\n  mutation CreateComment(\n    $input: CreateCommentInput!\n    $condition: ModelCommentConditionInput\n  ) {\n    createComment(input: $input, condition: $condition) {\n      id\n      message\n      post {\n        id\n        title\n        content\n        username\n        coverImage\n        comments {\n          nextToken\n        }\n        createdAt\n        updatedAt\n      }\n      postID\n      createdAt\n      updatedAt\n      createdBy\n    }\n  }\n"},9424:function(n,t,e){"use strict";e.d(t,{xl:function(){return r},aA:function(){return o},zu:function(){return i}});var r="\n  query GetPost($id: ID!) {\n    getPost(id: $id) {\n      id\n      title\n      content\n      username\n      coverImage\n      comments {\n        items {\n          id\n          message\n          postID\n          createdAt\n          updatedAt\n          createdBy\n        }\n        nextToken\n      }\n      createdAt\n      updatedAt\n    }\n  }\n",o="\n  query ListPosts(\n    $filter: ModelPostFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listPosts(filter: $filter, limit: $limit, nextToken: $nextToken) {\n      items {\n        id\n        title\n        content\n        username\n        coverImage\n        comments {\n          items {\n            id\n            message\n            postID\n            createdAt\n            updatedAt\n            createdBy\n          }\n        }\n        createdAt\n        updatedAt\n      }\n      nextToken\n    }\n  }\n",i="\n  query PostsByUsername(\n    $username: String!\n    $sortDirection: ModelSortDirection\n    $filter: ModelPostFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    postsByUsername(\n      username: $username\n      sortDirection: $sortDirection\n      filter: $filter\n      limit: $limit\n      nextToken: $nextToken\n    ) {\n      items {\n        id\n        title\n        content\n        username\n        coverImage\n        comments {\n          nextToken\n        }\n        createdAt\n        updatedAt\n      }\n      nextToken\n    }\n  }\n"}},function(n){n.O(0,[9774,552,8269,2888,179],(function(){return t=9537,n(n.s=t);var t}));var t=n.O();_N_E=t}]);